% Определяем функцию
f = @(x) exp(x) + log(x) - 10*x;

% Задаем интервал [a, b]
a = 3;
b = 4;

% Устанавливаем критерий остановки: точность и максимальное число итераций
tol = 1e-4;
maxIter = 100;

% Проверяем, что функция меняет знак на концах интервала
if f(a)*f(b) >= 0
    error('Функция имеет одинаковые знаки на концах интервала. Метод ложного положения не применим!');
end

% Инициализация переменных для хранения результатов итераций
iter = 0;
approx = zeros(maxIter,1);  % приближения корня
f_values = zeros(maxIter,1); % значения функции в точке приближения
errors = zeros(maxIter,1);   % разность между последовательными приближениями

% Заголовок таблицы в командном окне
fprintf('Iter\t   a\t\t   b\t\t   c\t\t  f(c)\t\t error\n');

while iter < maxIter
    % Вычисление точки по формуле метода ложного положения
    c = (a*f(b) - b*f(a)) / (f(b) - f(a));
    fc = f(c);
    iter = iter + 1;
    
    % Вычисляем ошибку как разность между текущим и предыдущим приближением
    if iter > 1
        errors(iter) = abs(c - approx(iter-1));
    else
        errors(iter) = 0; % для первой итерации
    end
    approx(iter) = c;
    f_values(iter) = fc;
    
    % Вывод текущей итерации в командное окно
    fprintf('%d\t%f\t%f\t%f\t%f\t%f\n', iter, a, b, c, fc, errors(iter));
    
    % Если достигнута заданная точность по значению функции или по изменению приближения, то выходим
    if abs(fc) < tol || (iter > 1 && errors(iter) < tol)
        break;
    end
    
    % Обновление границ интервала
    if f(a)*fc < 0
        b = c;
    else
        a = c;
    end
end

% Обрезаем массивы до реально выполненного количества итераций
approx = approx(1:iter);
f_values = f_values(1:iter);
iter_vector = 1:iter;

% Построение графиков
figure;
subplot(2,1,1)
plot(iter_vector, approx, 'o-', 'LineWidth', 2);
xlabel('Количество итераций');
ylabel('Приближение c');
title('График последовательных приближений значения корня');

subplot(2,1,2)
plot(iter_vector, f_values, 's-', 'LineWidth', 2);
xlabel('Количество итераций');
ylabel('Значение f(c)');
title('График значений функции при последовательных приближениях');
